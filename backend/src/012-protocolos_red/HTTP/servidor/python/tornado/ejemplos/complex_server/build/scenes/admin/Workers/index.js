"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(r,t,o){return t&&e(r.prototype,t),o&&e(r,o),r}}(),WorkersPage=function(){function e(){_classCallCheck(this,e),this.notifier=new Notifier,this._init_all(),this.getWorkers()}return _createClass(e,[{key:"_init_all",value:function(){this._init_modals(),this.workersList=new Vue(this._init_workersList())}},{key:"_init_modals",value:function(){this.addWorkerModal=this._addWorkerModal(),this._init_addWorkerModal(),this.editWorkerModal=this._editWorkerModal(),this._init_editWorkerModal()}},{key:"_addWorkerModal",value:function(){var e=$("#add-worker-modal"),r={inDuration:500,outDuration:200,startingTop:"50%",endingTop:"10%"};e.modal(r);var t={title:$("#add-worker-input-title"),address:$("#add-worker-input-address"),password:$("#add-worker-input-password")},o={inside:{cancel:$("#add-worker-modal-cancel"),save:$("#add-worker-modal-save")},out:{open:$("#add-worker-modal-trigger")}};return e.settings=r,e.inputs=t,e.buttons=o,e}},{key:"_init_addWorkerModal",value:function(){var e=this,r=this.addWorkerModal;r.buttons.out.open.click(function(){r.modal("open")}),r.buttons.inside.cancel.click(function(){r.modal("close")}),r.buttons.inside.save.click(function(){axios({method:"post",url:"/api/workers",params:{title:r.inputs.title.val(),address:r.inputs.address.val(),password:r.inputs.password.val()},xsrfCookieName:"_xsrf",xsrfHeaderName:"X-XSRFToken"}).then(function(r){200==r.status?(e.notifier.successMsg(r.data,4e3),e.getWorkers()):e.notifier.errorMsg(r.data,4e3)}).catch(function(r){e.notifier.errorMsg("Error adding worker. Please, try again.",4e3)}),r.modal("close")})}},{key:"_editWorkerModal",value:function(){var e=$("#edit-worker-modal"),r={inDuration:500,outDuration:200,startingTop:"50%",endingTop:"10%"};e.modal(r);var t={title:$("#edit-worker-input-title"),address:$("#edit-worker-input-address"),password:$("#edit-worker-input-password")},o={cancel:$("#edit-worker-modal-cancel"),save:$("#edit-worker-modal-save")},i={open:function(){e.modal("open")}};return e.settings=r,e.inputs=t,e.buttons=o,e.methods=i,e}},{key:"_init_editWorkerModal",value:function(){var e=this,r=this.editWorkerModal;r.buttons.cancel.click(function(){r.modal("close")}),r.buttons.save.click(function(){axios({method:"patch",url:"/api/workers",params:{title:r.inputs.title.val(),address:r.inputs.address.val(),password:r.inputs.password.val(),_id:r.temp_id},xsrfCookieName:"_xsrf",xsrfHeaderName:"X-XSRFToken"}).then(function(r){200==r.status?(e.notifier.successMsg(r.data,4e3),e.getWorkers()):e.notifier.errorMsg(r.data,4e3)}).catch(function(r){e.notifier.errorMsg("Error editing worker. Please, try again.",4e3)}),r.modal("close")})}},{key:"_init_workersList",value:function(){var e=this;return{delimiters:["${","}"],el:"#show-workers",data:{workers:[]},methods:{del:function(r){console.log("DELETE WORKER",r),axios({method:"delete",url:"/api/workers",params:{_id:r},xsrfCookieName:"_xsrf",xsrfHeaderName:"X-XSRFToken"}).then(function(r){200==r.status?(e.notifier.successMsg(r.data,3e3),e.getWorkers()):e.notifier.errorMsg(r.data,3e3),console.log(r)}).catch(function(r){e.notifier.errorMsg("Error removing worker. Please, try again.",3e3)})},edit:function(r,t,o,i){e.editWorkerModal.inputs.title.val(t),e.editWorkerModal.inputs.address.val(o),e.editWorkerModal.inputs.password.val(i),e.editWorkerModal.temp_id=r,e.editWorkerModal.methods.open(),console.log("EDIT WORKER",r,t,o,i)}}}}},{key:"getWorkers",value:function(){var e=this;axios({method:"get",url:"/api/workers"}).then(function(r){console.log(r),e.workersList.workers=r.data}).catch(function(e){console.log(e)})}}]),e}();$(document).ready(function(){new WorkersPage});